{"version":3,"file":"js/303.4132cf47.js","mappings":"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","sources":["webpack://angerpulse/./src/components/GuiaAudioteca.vue","webpack://angerpulse/./src/components/GuiaAudioteca.vue?0e02"],"sourcesContent":["<template>\n    <div v-show=\"!moment\">\n        <label class=\"b-24-black\" @click=\"updateShow\" v-html=\"t('audioteca.title')\"></label>\n        <br><br>\n        <div>\n            <p class=\"m-16-gray px-4 pt-2 pb-1\" v-html=\"t('audioteca.info')\">\n\n            </p>\n        </div>\n\n        <div class=\"audio-player\" v-if=\"songs.length > 0\">\n            <canvas ref=\"canvasRef\" width=\"256\" height=\"70\" class=\"visualizer\"></canvas>\n\n            <div class=\"song-info\">\n                <h3>{{ currentSongName }}</h3>\n                <div class=\"time\">\n                    {{ formatTime(currentTime) }} / {{ formatTime(duration) }}\n                </div>\n                <input type=\"range\" min=\"0\" :max=\"duration\" v-model=\"currentTime\" @input=\"seekAudio\" />\n            </div>\n            <div class=\"d-flex pb-5 pt-2\">\n                <img src=\"../assets/Atras.png\" class=\"m-auto\" @click=\"prevTrack\">\n                <img :src=\"isPlaying ? pauseIcon : playIcon\" style=\"height: 100%; width: fit-content; margin: auto;\"\n                    @click=\"togglePlay\">\n                <img src=\"../assets/Siguiente.png\" class=\"m-auto\" @click=\"nextTrack\">\n                <button @click=\"toggleShuffle\" :class=\"{ active: isShuffle }\" class=\"shuffle-button m-auto\">\n                    <img v-show=\"!isShuffle\" src=\"../assets/Aleatorio-dis.png\" class=\"m-auto\" width=\"35\">\n                    <img v-show=\"isShuffle\" src=\"../assets/Aleatorio-ava.png\" class=\"m-auto\" width=\"35\">\n                </button>\n            </div>\n        </div>\n        <div class=\"fullblack py-1\">\n            <p class=\"sb-20-white text-start\" v-html=\"t('audioteca.audioejercicios')\">\n\n            </p>\n            <div style=\"position: absolute; right: 20px; margin-top: -20px;\">\n                <img src=\"../assets/heart.png\" class=\"m-auto\">\n            </div>\n        </div>\n        <br>\n    </div>\n\n    <div v-show=\"moment\">\n        <div>\n            <div>\n                <label class=\"sb-20-black pb-4\" v-html=\"t('when.estabas')\"></label>\n                <ul class=\"ps-0\">\n                    <li class=\"list-group-item text-start r-16-gray py-2\">\n                        <div class=\"ps-5 form-check\">\n                            <input id=\"plan-m\" class=\"form-check-input\" type=\"radio\" name=\"plan\" value=\"1\"\n                                aria-label=\"...\">\n                            <label for=\"plan-m\" class=\"form-check-label\" v-html=\"t('when.act1')\"></label>\n                        </div>\n                    </li>\n                    <li class=\"list-group-item text-start r-16-gray py-2\">\n                        <div class=\"ps-5 form-check\">\n                            <input id=\"plan-s\" class=\"form-check-input\" type=\"radio\" name=\"plan\" value=\"2\"\n                                aria-label=\"...\">\n                            <label for=\"plan-s\" class=\"form-check-label\" v-html=\"t('when.act2')\">\n                            </label>\n                        </div>\n                    </li>\n                    <li class=\"list-group-item text-start r-16-gray py-2\">\n                        <div class=\"ps-5 form-check\">\n                            <input id=\"plan-a\" class=\"form-check-input\" type=\"radio\" name=\"plan\" value=\"3\"\n                                aria-label=\"...\">\n                            <label for=\"plan-a\" class=\"form-check-label\" v-html=\"t('when.act3')\"></label>\n                        </div>\n                    </li>\n                    <li class=\"list-group-item text-start r-16-gray py-2\">\n                        <div class=\"ps-5 form-check\">\n                            <input id=\"plan-4\" class=\"form-check-input\" type=\"radio\" name=\"plan\" value=\"4\"\n                                aria-label=\"...\">\n                            <label for=\"plan-4\" class=\"form-check-label\" v-html=\"t('when.act4')\"></label>\n                        </div>\n                    </li>\n                    <li class=\"list-group-item text-start r-16-gray py-2\">\n                        <div class=\"ps-5 form-check\">\n                            <input id=\"plan-5\" class=\"form-check-input\" type=\"radio\" name=\"plan\" value=\"5\"\n                                aria-label=\"...\">\n                            <label for=\"plan-5\" class=\"form-check-label\" v-html=\"t('when.act5')\"></label>\n                        </div>\n                    </li>\n\n                </ul>\n                <div class=\"d-flex justify-content-center pt-3 pb-5\">\n                    <div class=\"px-3\">\n                        <button type=\"button\" class=\"btn-gray-white\" @click=\"CloseMoment()\" v-html=\"t('homeplay.omitir')\">\n\n                        </button>\n                    </div>\n                    <div class=\"px-3\">\n                        <button type=\"button\" class=\"btn-black border-0\" @click=\"SetMoment()\"\n                            v-html=\"t('homeplay.guardar')\">\n\n                        </button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    <br><br>\n\n    <div v-if=\"songs.length === 0\" class=\"text-center py-5\">\n        <p class=\"b-18-gray\">No tienes pistas en tu audioteca</p>\n    </div>\n    <div v-else class=\"lista\" ref=\"listRef\">\n        <transition-group name=\"list\" tag=\"div\">\n            <div v-for=\"(song, index) in songs\" :key=\"song.id\" class=\"lisongs b-16-gray btn-group\"\n                :class=\"{ 'is-source': isDragging && index === currentIndex }\" role=\"group\"\n                @touchstart=\"startTouch(index, $event)\" @touchmove.prevent=\"onDrag($event)\" @touchend=\"endDrag\"\n                @touchcancel=\"endDrag\">\n                <div>\n                    <canvas v-show=\"index === currentIndex && isPlaying\" :ref=\"el => setMiniCanvasRef(el, index)\"\n                        width=\"40\" height=\"25\" class=\"mini-visualizer px-1\">\n                    </canvas>\n\n                    <button style=\"width: 48px;\" v-show=\"index != currentIndex\" class=\"btn-audio\"\n                        @click.stop=\"playSong(index)\">\n                        <img src=\"../assets/Play.png\" width=\"12\" class=\"m-auto\">\n                    </button>\n                </div>\n\n                <span style=\"flex: 1; cursor: pointer;\" class=\"text-start span-audio\">\n                    <label disabled v-if=\"editingIndex !== index\">{{ song.name }}</label>\n                    <input v-else v-model=\"editedName\" @keyup.enter=\"saveEdit(index)\" @blur=\"saveEdit(index)\" />\n                </span>\n\n                <button class=\"btn-audio\" @click.stop=\"editSong(index)\">\n                    <img src=\"../assets/Edit.png\" class=\"m-auto\">\n                </button>\n                <button class=\"btn-audio\" @click.stop=\"removeSong(index)\">\n                    <img src=\"../assets/Delete-song.png\" class=\"m-auto\">\n                </button>\n            </div>\n        </transition-group>\n    </div>\n\n    <div v-if=\"isDragging\" class=\"floating\" :style=\"floatingStyle\">\n        {{ dragText }}\n    </div>\n    <br><br><br>\n</template>\n\n<script setup>\nimport { ref, onMounted, onBeforeUnmount, computed } from 'vue'\nimport { useI18n } from 'vue-i18n'\nimport { API_BASE_URL } from '@/config/api'\n\nconst { t } = useI18n()\n\nconst songs = ref([])\n\nconst playIcon = new URL('@/assets/Play.png', import.meta.url).href\nconst pauseIcon = new URL('@/assets/Pausa.png', import.meta.url).href\n\nconst currentIndex = ref(0)\nconst moment = ref(false)\n\nconst isPlaying = ref(false)\nconst isShuffle = ref(true)\nconst currentTime = ref(0)\nconst duration = ref(0)\n// const audio = new Audio()\nconst audio = document.createElement('audio')\naudio.preload = 'auto'\naudio.playsInline = true\naudio.setAttribute('playsinline', '')\naudio.setAttribute('webkit-playsinline', '')\naudio.crossOrigin = 'anonymous' // opcional si hay CORS\naudio.muted = false\naudio.volume = 1\nconst idPlay = ref(0)\nconst durationSong = ref(0)\n\n\nconst countPause = ref(0)\n\nconst hasShownMessage = ref(false)\nlet playbackInterval = null\nconst playbackSeconds = ref(0)\n\nconst canvasRef = ref(null)\nlet audioContext, analyser, dataArray, source, animationId\nlet shuffledIndices = []\n\nconst currentSongName = computed(() => songs.value[currentIndex.value]?.name || '')\n\n// function setupVisualizer() {\n//     audioContext = new (window.AudioContext || window.webkitAudioContext)()\n//     analyser = audioContext.createAnalyser()\n//     analyser.fftSize = 256\n//     const bufferLength = analyser.frequencyBinCount\n//     dataArray = new Uint8Array(bufferLength)\n\n//     source = audioContext.createMediaElementSource(audio)\n//     source.connect(analyser)\n//     analyser.connect(audioContext.destination)\n\n//     drawVisualizer()\n\n//     if (audioContext.state === 'suspended') {\n//         const resume = () => {\n//             audioContext.resume()\n//             document.removeEventListener('touchstart', resume)\n//         }\n//         document.addEventListener('touchstart', resume, { once: true })\n//     }   \n// }\n\nfunction setupVisualizer() {\n    if (!audio) return\n    if (!audioContext) {\n        audioContext = new (window.AudioContext || window.webkitAudioContext)()\n    }\n\n    // si ya creamos la source anteriormente, evitar recrearla\n    if (!source) {\n        try {\n            // createMediaElementSource puede fallar si se llama varias veces sobre el mismo audio\n            source = audioContext.createMediaElementSource(audio)\n        } catch (e) {\n            console.warn('No se pudo crear MediaElementSource (quiz谩 ya existe):', e)\n        }\n    }\n\n    if (!analyser) {\n        analyser = audioContext.createAnalyser()\n        analyser.fftSize = 256\n        const bufferLength = analyser.frequencyBinCount\n        dataArray = new Uint8Array(bufferLength)\n    }\n\n    // conectar si no conectado\n    try {\n        if (source && analyser) {\n            source.connect(analyser)\n            analyser.connect(audioContext.destination)\n        }\n    } catch (e) {\n        console.warn('Error al conectar audio nodes:', e)\n    }\n\n    drawVisualizer()\n\n    // En iOS el context inicia suspendido; reanuda con el primer touch/click.\n    if (audioContext.state === 'suspended') {\n        const resume = async () => {\n            try {\n                await audioContext.resume()\n            } catch (err) {\n                console.warn('Error resuming audioContext:', err)\n            } finally {\n                document.removeEventListener('touchstart', resume)\n                document.removeEventListener('click', resume)\n            }\n        }\n        document.addEventListener('touchstart', resume, { once: true })\n        document.addEventListener('click', resume, { once: true })\n    }\n}\n\n\n\nfunction drawVisualizer() {\n    const mainCanvas = canvasRef.value\n    const mainCtx = mainCanvas.getContext('2d')\n    const width = mainCanvas.width\n    const height = mainCanvas.height\n    const centerY = height / 2\n\n    function draw() {\n        animationId = requestAnimationFrame(draw)\n        analyser.getByteFrequencyData(dataArray)\n\n        // Canvas principal\n        mainCtx.clearRect(0, 0, width, height)\n        const barWidth = width / dataArray.length\n        let x = 0\n        for (let i = 0; i < dataArray.length; i++) {\n            const value = dataArray[i]\n            const barHeight = value / 2\n            const gradient = mainCtx.createLinearGradient(0, centerY - barHeight, 0, centerY + barHeight)\n            gradient.addColorStop(0, '#00f')\n            gradient.addColorStop(1, '#0ff')\n            mainCtx.fillStyle = gradient\n            mainCtx.fillRect(x, centerY - barHeight, barWidth, barHeight)\n            mainCtx.fillRect(x, centerY, barWidth, barHeight)\n            x += barWidth + 1\n        }\n\n        // Mini visualizador (solo para la canci贸n actual)\n        const miniCanvas = miniCanvasRefs.value[currentIndex.value]\n        if (miniCanvas) {\n            const miniCtx = miniCanvas.getContext('2d')\n            miniCtx.clearRect(0, 0, miniCanvas.width, miniCanvas.height)\n            const miniBarWidth = miniCanvas.width / dataArray.length\n            let mx = 0\n            for (let i = 0; i < dataArray.length; i++) {\n                const value = dataArray[i]\n                const barHeight = value / 3\n                miniCtx.fillStyle = '#0af'\n                miniCtx.fillRect(mx, miniCanvas.height - barHeight, miniBarWidth, barHeight)\n                mx += miniBarWidth + 1\n            }\n        }\n    }\n\n    draw()\n}\n\nfunction shuffleArray(length) {\n    const indices = [...Array(length).keys()]\n    for (let i = indices.length - 1; i > 0; i--) {\n        const j = Math.floor(Math.random() * (i + 1))\n            ;[indices[i], indices[j]] = [indices[j], indices[i]]\n    }\n    return indices\n}\nfunction CloseMoment() {\n  moment.value = false\n}\n\n// \nfunction loadTrack(index) {\n    const song = songs.value[index]\n    if (!song) return\n    audio.src = song.url\n    durationSong.value = 0\n    audio.load()\n    audio.muted = false\n    audio.volume = 1\n    stopPlaybackTimer()\n    // si quieres reproducir inmediatamente SOLO si isPlaying est谩 true\n    if (isPlaying.value) {\n        // Asegura que el audioContext est茅 activo antes de play\n        if (audioContext && audioContext.state === 'suspended') {\n            audioContext.resume().catch(e => console.warn('resume fall贸', e))\n        }\n        audio.play().then(() => {\n            isPlaying.value = true\n            startPlaybackTimer()\n        }).catch(err => {\n            console.warn('iOS puede haber bloqueado la reproducci贸n:', err)\n        })\n    } else {\n        isPlaying.value = false\n    }\n}\n\n\n// function togglePlay() {\n//     if (audio.paused) {\n//         audio.play()\n//         isPlaying.value = true\n//         startPlaybackTimer()\n//     } else {\n//         audio.pause()\n//         isPlaying.value = false\n//         stopPlaybackTimer()\n//         countPause.value++;\n//         if (playbackSeconds.value >= 110 | (playbackSeconds.value >= 107 && countPause.value > 2)) {\n//             moment.value = true;\n//             playbackSeconds.value = 0;\n//             hasShownMessage.value = true\n//             countPause.value = 0\n//         }\n//     }\n// }\n\nasync function togglePlay() {\n    try {\n        if (audioContext && audioContext.state === 'suspended') {\n            // garantizamos que se reanude con la interacci贸n del usuario\n            await audioContext.resume()\n        }\n    } catch (err) {\n        console.warn('No se pudo reanudar audioContext:', err)\n    }\n\n    if (audio.paused) {\n        try {\n            // aseg煤rate el elemento no est茅 mute y volumen ok\n            audio.muted = false\n            audio.volume = 1\n            await audio.play()\n            isPlaying.value = true\n            startPlaybackTimer()\n        } catch (err) {\n            console.warn('Error al play (iOS puede bloquear):', err)\n        }\n    } else {\n        SetPlay(1)\n        audio.pause()\n        isPlaying.value = false\n        stopPlaybackTimer()\n        countPause.value++;\n        if (!hasShownMomentThisSession() && (playbackSeconds.value >= 10 | (playbackSeconds.value >= 9 && countPause.value > 1)) ){\n            moment.value = true;\n            playbackSeconds.value = 0;\n            markMomentAsShown()   \n            hasShownMessage.value = true\n            countPause.value = 0\n        }\n    }\n}\n\n\nfunction startPlaybackTimer() {\n    if (playbackInterval) return // Evita m煤ltiples intervalos\n\n    playbackInterval = setInterval(() => {\n        playbackSeconds.value++\n         durationSong.value++\n    }, 1000)\n}\n\nfunction stopPlaybackTimer() {\n    clearInterval(playbackInterval)\n    playbackInterval = null\n}\n\nfunction nextTrack() {\n    SetPlay(0)\n    if (isShuffle.value) {\n        if (shuffledIndices.length === 0) {\n            shuffledIndices = shuffleArray(songs.value.length)\n        }\n        currentIndex.value = shuffledIndices.shift()\n    } else {\n        currentIndex.value = (currentIndex.value + 1) % songs.value.length\n    }\n    isPlaying.value = true\n    loadTrack(currentIndex.value)\n}\n\nfunction prevTrack() {\n    SetPlay(0)\n    if (isShuffle.value) {\n        if (shuffledIndices.length === 0) {\n            shuffledIndices = shuffleArray(songs.value.length)\n        }\n        currentIndex.value = shuffledIndices.shift()\n    } else {\n        currentIndex.value = (currentIndex.value - 1 + songs.value.length) % songs.value.length\n    }\n    isPlaying.value = true\n    loadTrack(currentIndex.value)\n}\n\nfunction toggleShuffle() {\n    isShuffle.value = !isShuffle.value\n\n    if (isShuffle.value) {\n        shuffledIndices = shuffleArray(songs.value.length)\n        // Evita repetir la canci贸n actual\n        shuffledIndices = shuffledIndices.filter(i => i !== currentIndex.value)\n    } else {\n        shuffledIndices = []\n    }\n}\n\nfunction seekAudio() {\n    audio.currentTime = currentTime.value\n}\n\naudio.addEventListener('timeupdate', () => {\n    currentTime.value = audio.currentTime\n    duration.value = audio.duration || 0\n})\n\naudio.addEventListener('ended', () => {\n    nextTrack()\n})\n\nfunction formatTime(time) {\n    const minutes = Math.floor(time / 60)\n    const seconds = Math.floor(time % 60).toString().padStart(2, '0')\n    return `${minutes}:${seconds}`\n}\n\n// const audios = ref([]);\nfunction limpiarNombre(nombre) {\n    return nombre.replace(/\\.[^.]+(?=\\.\\w+$)/, '') // quita hash intermedio\n}\n\nasync function GetAudios() {\n    try {\n        const sesion = localStorage.getItem(\"token\")\n        if (!sesion) return\n        const response = await fetch(`${API_BASE_URL}/api/audioteca/GetAudioteca`, {\n            method: \"POST\",\n            headers: { \"Content-Type\": \"application/json\" },\n            body: JSON.stringify({ username: sesion })\n        })\n\n        if (!response.ok) throw new Error(\"Error en la petici贸n\")\n\n        const data = await response.json()\n\n        if (data.data != \"\") {\n            const dataAudios = Array.isArray(JSON.parse(data.data)) ? JSON.parse(data.data) : data.data\n            if (!Array.isArray(dataAudios)) throw new Error(\"dataAudios no es un array\")\n\n\n            const arr = dataAudios.map(item => {\n                const limpio = limpiarNombre(item.NombreAudio)\n                return {\n                    id: item.Id_Audioteca,\n                    url: `/audios/${limpio}`,\n                    nombre: item.Nombre\n                }\n            })\n\n            songs.value = arr.map(item => ({\n                id: item.id,\n                name: item.nombre,\n                url: item.url\n            }))\n            // audios.value = arr\n\n            // Cargar primer track solo despu茅s de tener audios\n            if (songs.value.length > 0) {\n                loadTrack(0)\n            }\n        }\n        else {\n            songs.value = [];\n            return;\n        }\n\n    } catch (error) {\n        console.error(\"Error al cargar audios:\", error)\n    }\n}\n\nasync function initAudioPlayer() {\n  await GetAudios() // carga los audios primero\n  if (songs.value.length === 0) return\n\n  loadTrack(0)\n  setupVisualizer()\n}\n\nonMounted(() => {\n    initAudioPlayer()\n    // GetAudios()\n    // setupVisualizer()\n    // loadTrack(currentIndex.value)\n})\n\nonBeforeUnmount(() => {\n    cancelAnimationFrame(animationId)\n    audio.pause()\n    audio.src = ''\n    if (audioContext) audioContext.close()\n})\n\n\n\nconst editingIndex = ref(null)\nconst editedName = ref('')\n\nfunction playSong(index) {\n    isPlaying.value = true\n    currentIndex.value = index\n    loadTrack(index)\n    startPlaybackTimer()\n    isPlaying.value = true\n}\n\nfunction removeSong(index) {\n    const songToDelete = songs.value[index]\n\n    const isCurrent = currentIndex.value === index\n    if (isCurrent) {\n        audio.pause()\n        isPlaying.value = false\n        stopPlaybackTimer()\n    }\n    \n    // if (currentIndex.value === index) {\n    //     audio.pause()\n    // }\n     // Ajustamos currentIndex si es necesario\n    if (songs.value.length === 0) {\n        // No quedan canciones\n        currentIndex.value = 0\n        audio.src = ''\n        return\n    }\n     if (currentIndex.value > index) {\n        // Si la canci贸n eliminada estaba antes de la actual, decrementamos el 铆ndice\n        currentIndex.value -= 1\n    } else if (currentIndex.value === index) {\n        // Si eliminamos la canci贸n actual, cargamos la siguiente disponible\n        if (currentIndex.value >= songs.value.length) {\n            currentIndex.value = 0\n        }\n    }\n\n    // Llamamos a la API para eliminar favorito\n    DeleteFavorite(songToDelete.id)\n    // Si queda alguna canci贸n, la cargamos y reproducimos\n    if (songs.value.length > 0) {\n        loadTrack(currentIndex.value)\n        isPlaying.value = true\n        startPlaybackTimer()\n    }\n    songs.value.splice(index, 1)\n    if (currentIndex.value >= songs.value.length) {\n        currentIndex.value = 0\n    }\n    // DeleteFavorite()\n    // loadTrack(currentIndex.value)\n}\n\nasync function DeleteFavorite(audiotecaId) {\n  try {\n    const sesion = localStorage.getItem(\"token\")\n    if (!sesion) return\n    // const currentAudio = songs.value[currentIndex.value]\n\n    const response = await fetch(`${API_BASE_URL}/api/audioteca/SetAudiotecaEstatus`, {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({ audioteca: audiotecaId  + ''  })\n    })\n\n    if (!response.ok) throw new Error(\"Error en la petici贸n\")\n\n  } catch (error) {\n    console.error(\"Error al cargar audios:\", error)\n  }\n}\n\n\nfunction editSong(index) {\n    editingIndex.value = index\n    editedName.value = songs.value[index].name\n}\n\nasync function saveEdit(index) {\n    const newName = editedName.value.trim()\n    if (!newName) {\n        editingIndex.value = null\n        return\n    }\n\n    // Actualizamos el nombre localmente\n    songs.value[index].name = newName\n\n    // Llamamos a la API para actualizar el nombre en el backend\n    try {\n        await ChangeName(songs.value[index].id, newName)\n    } catch (error) {\n        console.error(\"Error al cambiar el nombre en el servidor:\", error)\n        // Opcional: revertir el cambio local si falla la API\n        // songs.value[index].name = originalName\n    }\n\n    editingIndex.value = null\n\n    // if (editedName.value.trim()) {\n    //     songs.value[index].name = editedName.value.trim()\n    // }\n    // editingIndex.value = null\n}\n\nasync function ChangeName(audiotecaId, nameAudio) {\n  try {\n\n    const response = await fetch(`${API_BASE_URL}/api/audioteca/SetAudiotecaName`, {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({ idaudioteca: audiotecaId  + '', name: nameAudio })\n    })\n\n    if (!response.ok) throw new Error(\"Error en la petici贸n\")\n\n  } catch (error) {\n    console.error(\"Error al cargar audios:\", error)\n  }\n}\n\nconst miniCanvasRefs = ref({})\n// const canvasRefs = ref([])\nfunction setMiniCanvasRef(el, index) {\n    if (el) miniCanvasRefs.value[index] = el\n    //***** */\n    //else delete miniCanvasRefs.value[index]\n}\n\n\n\nconst listRef = ref(null)\n\n// Drag & touch\nconst isDragging = ref(false)\nconst readyIndex = ref(null)\nconst dragText = ref(\"\")\nconst fingerOffsetY = ref(0)\nconst floatY = ref(0)\nconst containerRect = ref({ top: 0, bottom: 0, left: 0, width: 0 })\n\nlet touchTimer = null // temporizador para delay de drag\n\nconst floatingStyle = computed(() => ({\n    position: \"fixed\",\n    top: `${Math.min(Math.max(floatY.value - fingerOffsetY.value, containerRect.value.top),\n        containerRect.value.bottom - 1)}px`,\n    left: `${containerRect.value.left}px`,\n    width: `${containerRect.value.width}px`,\n    zIndex: 9999,\n    pointerEvents: \"none\"\n}))\n\nfunction startTouch(index, e) {\n    // Guardamos info para el posible drag\n    const t = e.touches[0]\n    const el = e.currentTarget\n    const itemRect = el.getBoundingClientRect()\n    const listBox = listRef.value.getBoundingClientRect()\n    containerRect.value = {\n        top: listBox.top,\n        bottom: listBox.bottom,\n        left: listBox.left,\n        width: listBox.width\n    }\n\n    fingerOffsetY.value = t.clientY - itemRect.top\n    floatY.value = t.clientY\n\n    // Iniciamos temporizador de 2s para drag\n    touchTimer = setTimeout(() => {\n        isDragging.value = true\n        currentIndex.value = index\n        dragText.value = songs.value[index].name\n    }, 500)\n}\n\nfunction onDrag(e) {\n    if (!isDragging.value)\n        return\n\n    const t = e.touches[0]\n    floatY.value = t.clientY\n\n    const targetIndex = indexFromY(t.clientY)\n    if (targetIndex == null || targetIndex === currentIndex.value) return\n\n    const arr = songs.value\n    const moved = arr.splice(currentIndex.value, 1)[0]\n    arr.splice(targetIndex, 0, moved)\n    currentIndex.value = targetIndex\n}\n// const canvasRefs = ref([])\n\nfunction endDrag() {\n    clearTimeout(touchTimer)\n    if (!isDragging.value) return\n\n    // Guardamos el 铆ndice del item que se solt贸\n    const releasedIndex = currentIndex.value\n\n    // Reset de estado drag\n    isDragging.value = false\n    currentIndex.value = null\n    dragText.value = \"\"\n    readyIndex.value = null\n    document.querySelectorAll('.lisongs').forEach(item => item.classList.remove('is-ready'))\n\n    isPlaying.value = true\n    currentIndex.value = releasedIndex\n    // loadTrack(index)\n    startPlaybackTimer()\n    isPlaying.value = true\n}\n\n\nfunction indexFromY(y) {\n    const container = listRef.value\n    if (!container) return null\n    const children = Array.from(container.querySelectorAll(\".lisongs\"))\n    if (!children.length) return null\n    for (let i = 0; i < children.length; i++) {\n        const r = children[i].getBoundingClientRect()\n        const mid = r.top + r.height / 2\n        if (y < mid) return i\n    }\n    return children.length - 1\n}\n\nasync function SetMoment() {\n  try {\n    const sesion = localStorage.getItem(\"token\")\n    if (!sesion) return\n    // const currentAudio = songs.value[currentIndex.value]\n\n    const response = await fetch(`${API_BASE_URL}/api/config/SetMoment`, {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      //body: JSON.stringify({idMomento: document.querySelector('input[name=\"plan\"]:checked').value, idUser: sesion, idAudio: currentAudio.id + ''  })\n        body: JSON.stringify({idMomento: document.querySelector('input[name=\"plan\"]:checked').value, idUser: sesion, idAudio: idPlay.value  })\n    })\n    moment.value = false\n    if (!response.ok) throw new Error(\"Error en la petici贸n\")\n\n  } catch (error) {\n    console.error(\"Error al cargar audios:\", error)\n    moment.value = false\n  }\n}\n\nasync function SetPlay(x) {\n  try {\n    const sesion = localStorage.getItem(\"token\")\n    if (!sesion) return\n    const currentAudio = songs.value[currentIndex.value]\n\n    const response = await fetch(`${API_BASE_URL}/api/config/SetPlay`, {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({idReproduccion: idPlay.value, tiempo: durationSong.value, idUser: sesion, idAudio: currentAudio.id + '', home: false })\n    })\n    const data = await response.json()\n    if (!response.ok) throw new Error(\"Error en la petici贸n\")\n    else{\n      if(x==0)\n        idPlay.value = 0\n      else\n      idPlay.value = data.data\n    }\n  } catch (error) {\n    console.error(\"Error al cargar audios:\", error)\n  }\n}\n\n\n\nconst MOMENT_SESSION_KEY = 'moment_popup_session'\n\nfunction getHalfHourSessionKey() {\n  const now = new Date()\n\n  const year = now.getFullYear()\n  const month = String(now.getMonth() + 1).padStart(2, '0')\n  const day = String(now.getDate()).padStart(2, '0')\n  const hour = String(now.getHours()).padStart(2, '0')\n\n  const minutes = now.getMinutes()\n\n  //  tu l贸gica especial\n  const block = minutes <= 30 ? '01-30' : '31-00'\n\n  return `${year}-${month}-${day}-${hour}-${block}`\n}\n\nfunction hasShownMomentThisSession() {\n  const currentSession = getHalfHourSessionKey()\n  return localStorage.getItem(MOMENT_SESSION_KEY) === currentSession\n}\n\nfunction markMomentAsShown() {\n  const currentSession = getHalfHourSessionKey()\n  localStorage.setItem(MOMENT_SESSION_KEY, currentSession)\n}\n</script>\n\n<style scoped>\n.audio-player {\n    text-align: center;\n    background: #fff;\n    padding: 1rem;\n    border-radius: 8px;\n    color: #555;\n}\n\n.visualizer {\n    display: block;\n    margin: 1rem auto;\n    background-color: white;\n}\n\n.song-info {\n    margin: 1rem 0;\n}\n\n.song-info h3 {\n    margin: 0;\n}\n\n.song-info .time {\n    font-size: 0.9rem;\n    margin-bottom: 0.5rem;\n}\n\n.song-info input[type=range] {\n    width: 100%;\n}\n\n.controls button {\n    background: none;\n    border: none;\n    margin: 0 1rem;\n    cursor: pointer;\n    color: white;\n}\n\n.controls img {\n    width: 40px;\n    height: 40px;\n}\n\n.controls .active {\n    color: lime;\n}\n\n.shuffle-button {\n    background: none;\n    border: none;\n    font-size: 1.5rem;\n    cursor: pointer;\n    color: #aaa;\n}\n\n.shuffle-button.active {\n    color: #0ff;\n}\n\n.mini-visualizer {\n    margin-top: 4px;\n    background-color: #fff;\n    display: block;\n}\n\n.song-item.active-song {\n    background-color: #e8f8ff;\n    border-left: 4px solid #0af;\n}\n\n.lisongs {\n    display: flex;\n    align-items: center;\n    margin-bottom: 0.5rem;\n    /* cursor: move; */\n    border: 1px solid #D6D6D6;\n    /* border-radius: 10px; */\n}\n\n.btn-audio {\n    border: none;\n    background-color: transparent;\n    border-left: 1px solid #D6D6D6;\n    padding: 7px 10px;\n}\n\n.span-audio {\n    background-color: #F4F4F4;\n    padding-top: 0px;\n    padding-bottom: 0px;\n    border-left: 1px solid #D6D6D6;\n}\n\n.span-audio>input {\n    border: none;\n    width: 100%;\n    padding-left: 10px;\n}\n\n.span-audio>input:focus {\n    border: none;\n    width: 100%;\n    padding-left: 10px;\n    outline: none;\n}\n\n.span-audio>label {\n    padding-top: 7px;\n    padding-bottom: 7px;\n    padding-left: 10px;\n}\n\n.svg {\n    transform: rotate(180deg);\n}\n\n.lista {\n    /* width: 320px;\n    margin: 20px auto;\n    display: flex;\n    flex-direction: column;\n    gap: 8px; */\n    touch-action: none;\n    /* clave en iOS para permitir touchmove continuo */\n    -webkit-user-select: none;\n    user-select: none;\n}\n\n/* .item {\n    padding: 14px 16px;\n    background: #f9f9f9;\n    border: 2px solid #ccc;\n    border-radius: 10px;\n    text-align: center;\n    font-size: 18px; \n} */\n\n/* Oculta el original pero mantiene el espacio para que no colapse el layout */\n.is-source {\n    visibility: hidden;\n}\n\n/* tem flotante que sigue el dedo */\n.floating {\n    background: #e3f2fd;\n    border: 2px solid #90caf9;\n    border-radius: 12px;\n    box-shadow: 0 10px 24px rgba(0, 0, 0, 0.18);\n    padding: 14px 16px;\n}\n\n/* Animaci贸n de desplazamiento al reordenar */\n.list-move {\n    transition: transform 0.2s ease;\n}\n\n.floating {\n    background: #e3f2fd;\n    border: 2px solid #90caf9;\n    border-radius: 12px;\n    padding: 8px 12px;\n    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.18);\n    pointer-events: none;\n}\n\n/* tem seleccionado para drag (despu茅s del delay) */\n.is-ready {\n    transform: scale(1.05);\n    /* aumenta tama帽o ligeramente */\n    background-color: #d1eaff;\n    /* ilumina un poco */\n    border-color: #42a5f5;\n    /* opcional: borde m谩s fuerte */\n    transition: transform 0.2s, background-color 0.2s, border-color 0.2s;\n}\n</style>","import script from \"./GuiaAudioteca.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./GuiaAudioteca.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./GuiaAudioteca.vue?vue&type=style&index=0&id=5fa175b4&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-5fa175b4\"]])\n\nexport default __exports__"],"names":["MOMENT_SESSION_KEY","t","useI18n","songs","ref","playIcon","URL","href","pauseIcon","currentIndex","moment","isPlaying","isShuffle","currentTime","duration","audio","document","createElement","preload","playsInline","setAttribute","crossOrigin","muted","volume","idPlay","durationSong","countPause","hasShownMessage","playbackInterval","playbackSeconds","canvasRef","audioContext","analyser","dataArray","source","animationId","shuffledIndices","currentSongName","computed","value","name","setupVisualizer","window","AudioContext","webkitAudioContext","createMediaElementSource","e","console","warn","createAnalyser","fftSize","bufferLength","frequencyBinCount","Uint8Array","connect","destination","drawVisualizer","state","resume","async","err","removeEventListener","addEventListener","once","mainCanvas","mainCtx","getContext","width","height","centerY","draw","requestAnimationFrame","getByteFrequencyData","clearRect","barWidth","length","x","i","barHeight","gradient","createLinearGradient","addColorStop","fillStyle","fillRect","miniCanvas","miniCanvasRefs","miniCtx","miniBarWidth","mx","shuffleArray","indices","Array","keys","j","Math","floor","random","CloseMoment","loadTrack","index","song","src","url","load","stopPlaybackTimer","catch","play","then","startPlaybackTimer","togglePlay","paused","SetPlay","pause","hasShownMomentThisSession","markMomentAsShown","setInterval","clearInterval","nextTrack","shift","prevTrack","toggleShuffle","filter","seekAudio","formatTime","time","minutes","seconds","toString","padStart","limpiarNombre","nombre","replace","GetAudios","sesion","localStorage","getItem","response","fetch","API_BASE_URL","method","headers","body","JSON","stringify","username","ok","Error","data","json","dataAudios","isArray","parse","arr","map","item","limpio","NombreAudio","id","Id_Audioteca","Nombre","error","initAudioPlayer","onMounted","onBeforeUnmount","cancelAnimationFrame","close","editingIndex","editedName","playSong","removeSong","songToDelete","isCurrent","DeleteFavorite","splice","audiotecaId","audioteca","editSong","saveEdit","newName","trim","ChangeName","nameAudio","idaudioteca","setMiniCanvasRef","el","listRef","isDragging","readyIndex","dragText","fingerOffsetY","floatY","containerRect","top","bottom","left","touchTimer","floatingStyle","position","min","max","zIndex","pointerEvents","startTouch","touches","currentTarget","itemRect","getBoundingClientRect","listBox","clientY","setTimeout","onDrag","targetIndex","indexFromY","moved","endDrag","clearTimeout","releasedIndex","querySelectorAll","forEach","classList","remove","y","container","children","from","r","mid","SetMoment","idMomento","querySelector","idUser","idAudio","currentAudio","idReproduccion","tiempo","home","getHalfHourSessionKey","now","Date","year","getFullYear","month","String","getMonth","day","getDate","hour","getHours","getMinutes","block","currentSession","setItem","__exports__"],"sourceRoot":""}