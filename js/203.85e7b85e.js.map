{"version":3,"file":"js/203.85e7b85e.js","mappings":"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","sources":["webpack://angerpulse/./src/components/AngerDashboard.vue","webpack://angerpulse/./src/components/AngerDashboard.vue?1aa7"],"sourcesContent":["<template>\r\n  <div>\r\n    <label class=\"b-24-black\" v-html=\"t('activity.title')\"></label>\r\n    <br>\r\n  </div>\r\n  <div class=\"text-start px-4 pt-3\">\r\n    <p class=\"b-16-gray\" v-html=\"t('activity.temporalidad')\"></p>\r\n    <select id=\"FilterTempo\" class=\"form-control w-100 select-ap\" v-model=\"selectedOption\"\r\n      @change=\"GetDatos(selectedOption)\" v-html=\"t('activity.ultsem')\">\r\n    </select>\r\n    <div class=\"numeralia d-flex py-3\">\r\n      <div class=\"num-circle\">\r\n        <div class=\"circle-black b-48-gray p-3\">\r\n          <label class=\"m-auto\">{{ countAudios }}</label>\r\n        </div>\r\n      </div>\r\n      <div class=\"data-rec b-20-gray w-100\">\r\n        <label class=\"m-auto px-3 b-20-gray\" v-html=\"t('activity.audio')\"></label>\r\n      </div>\r\n    </div>\r\n    <div class=\"numeralia d-flex py-3\">\r\n  <!-- Si hay horas -->\r\n  <div v-if=\"tiempoResumen.h > 0\" class=\"num-circle\">\r\n    <div class=\"circle-black b-20-gray p-3\">\r\n      <label class=\"m-auto\">\r\n        {{ tiempoResumen.h }}:{{ tiempoResumen.m.toString().padStart(2, '0') }}:{{ tiempoResumen.s.toString().padStart(2, '0') }}h\r\n      </label>\r\n    </div>\r\n  </div>\r\n  \r\n  <!-- Si no hay horas pero hay minutos -->\r\n  <div v-else-if=\"tiempoResumen.m > 0\" class=\"num-circle\">\r\n    <div class=\"circle-black b-20-gray p-3\">\r\n      <label class=\"m-auto\">\r\n        {{ tiempoResumen.m }}:{{ tiempoResumen.s.toString().padStart(2, '0') }}m\r\n      </label>\r\n    </div>\r\n  </div>\r\n  \r\n  <!-- Si solo hay segundos -->\r\n  <div v-else class=\"num-circle\">\r\n    <div class=\"circle-black b-20-gray p-3\">\r\n      <label class=\"m-auto\">\r\n        {{ tiempoResumen.s.toString().padStart(2, '0') }}s\r\n      </label>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"data-rec b-20-gray w-100\">\r\n    <label class=\"m-auto px-3 b-20-gray\" v-html=\"t('activity.horas')\"></label>\r\n  </div>\r\n</div>\r\n\r\n  </div>\r\n  <!--Gráfica de barras-->\r\n  <div class=\"card p-4 mt-4 shadow-sm\">\r\n    <p class=\"b-16-gray pt-2 pb-1 text-start\" v-html=\"t('activity.dias')\"></p>\r\n    <div class=\"d-flex align-items-center mb-3\">\r\n      <!-- Botón de regreso dinámico -->\r\n      <button v-if=\"temporalidad < 3\" @click=\"goBack\" class=\"btn btn-sm btn-outline-secondary me-3\">\r\n        ← {{ t('activity.btnBack') }}\r\n      </button>\r\n    </div>\r\n    <div style=\"height: 300px; width: 100%;\">\r\n      <Bar v-if=\"apiData.length > 0\" :data=\"chartData\" :options=\"chartOptions\" />\r\n      <div v-else class=\"d-flex justify-content-center align-items-center h-100\">\r\n        <p class=\"text-muted\">{{ t('common.noData') }}</p>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <!--Mapa de calor-->\r\n  <div class=\"py-3 px-4\">\r\n    <p class=\"b-16-gray pt-2 pb-1 text-start\" v-html=\"t('activity.momentos')\">\r\n    </p>\r\n    <div>\r\n      <table class=\"pila-table\">\r\n        <tbody>\r\n          <tr v-for=\"rowIndex in maxRows\" :key=\"rowIndex\">\r\n            <td v-for=\"header in tableHeaders\" :key=\"header.name\">\r\n              <div v-if=\"tableColumns[header.name][maxRows - rowIndex]\" class=\"bloque-celda-wrapper\">\r\n                <div class=\"bloque-celda\"\r\n                  :style=\"{ backgroundColor: getMomentoColor(tableColumns[header.name][maxRows - rowIndex].Momento) }\"\r\n                  @click=\"toggleTooltip(tableColumns[header.name][maxRows - rowIndex], $event)\">\r\n                  {{ tableColumns[header.name][maxRows - rowIndex].Bloque }}\r\n                  <div v-if=\"selectedBlock === tableColumns[header.name][maxRows - rowIndex]\" class=\"custom-tooltip\">\r\n                    <strong>{{ t('activity.audioMin') }}:</strong> {{ selectedBlock.Cantidad }} \r\n                    <br>\r\n                    <strong>{{ t('activity.horasMin') }}:</strong> {{ formatTiempo(selectedBlock.Tiempo) }}\r\n                    <div class=\"tooltip-arrow\"></div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </td>\r\n          </tr>\r\n        </tbody>\r\n        <tfoot style=\"font-size: 12px;\">\r\n          <tr>\r\n            <th v-for=\"header in tableHeaders\" :key=\"header.name\">\r\n              {{ header.name }}\r\n            </th>\r\n          </tr>\r\n        </tfoot>\r\n      </table>\r\n    </div>\r\n    <div class=\"d-flex justify-content-start pt-4\">\r\n      <div class=\"mini-square\" style=\"background-color: #efefef; margin-top:2px;\"></div>\r\n      <div class=\"ps-3\">\r\n        <div class=\"b-14-gray text-start\">\r\n          {{ t('activity.registro') }}\r\n        </div>\r\n        <div class=\"r-12-gray text-start\" v-tooltip=\"t('activity.audio')\"\r\n          style=\"padding-right: 10px; width: fit-content; cursor: help;\">\r\n          {{ t('activity.audioMin') }}: {{ resumenMomentos[0] || 0 }}\r\n        </div>\r\n        <div class=\"r-12-gray text-start\" v-tooltip=\"t('activity.horas')\"\r\n          style=\"padding-right: 10px; width: fit-content; cursor: help;\">\r\n          {{ t('activity.horasMin') }}: {{ formatTiempo(resumenTiempo?.[0] || 0) }}\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"d-flex justify-content-start pt-4\">\r\n      <div class=\"mini-square\" style=\"background-color: #E3FCFF; margin-top:2px;\"></div>\r\n      <div class=\"ps-3\">\r\n        <div class=\"b-14-gray text-start\">\r\n          {{ t('activity.act') }}\r\n        </div>\r\n        <div class=\"r-12-gray text-start\" v-tooltip=\"t('activity.audio')\"\r\n          style=\"padding-right: 10px; width: fit-content; cursor: help;\">\r\n          {{ t('activity.audioMin') }}: {{ resumenMomentos[1] || 0 }}\r\n        </div>\r\n        <div class=\"r-12-gray text-start\" v-tooltip=\"t('activity.horas')\"\r\n          style=\"padding-right: 10px; width: fit-content; cursor: help;\">\r\n          {{ t('activity.horasMin') }}: {{ formatTiempo(resumenTiempo?.[1] || 0) }}\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"d-flex justify-content-start pt-3\">\r\n      <div class=\"mini-square\" style=\"background-color: #FFE4B3; margin-top:2px;\"></div>\r\n      <div class=\"ps-3\">\r\n        <div class=\"b-14-gray text-start\">\r\n          {{ t('activity.mente') }}\r\n        </div>\r\n        <div class=\"r-12-gray text-start\" v-tooltip=\"t('activity.audio')\"\r\n          style=\"padding-right: 10px; width: fit-content; cursor: help;\">\r\n          {{ t('activity.audioMin') }}: {{ resumenMomentos[2] || 0 }}\r\n        </div>\r\n        <div class=\"r-12-gray text-start\" v-tooltip=\"t('activity.horas')\"\r\n          style=\"padding-right: 10px; width: fit-content; cursor: help;\">\r\n          {{ t('activity.horasMin') }}: {{ formatTiempo(resumenTiempo?.[2] || 0) }}\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"d-flex justify-content-start pt-3\">\r\n      <div class=\"mini-square\" style=\"background-color: #FFC4B3; margin-top:2px;\"></div>\r\n      <div class=\"ps-3\">\r\n        <div class=\"b-14-gray text-start\">\r\n          {{ t('activity.lugares') }}\r\n        </div>\r\n        <div class=\"r-12-gray text-start\" v-tooltip=\"t('activity.audio')\"\r\n          style=\"padding-right: 10px; width: fit-content; cursor: help;\">\r\n          {{ t('activity.audioMin') }}: {{ resumenMomentos[3] || 0 }}\r\n        </div>\r\n        <div class=\"r-12-gray text-start\" v-tooltip=\"t('activity.horas')\"\r\n          style=\"padding-right: 10px; width: fit-content; cursor: help;\">\r\n          {{ t('activity.horasMin') }}: {{ formatTiempo(resumenTiempo?.[3] || 0) }}\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"d-flex justify-content-start pt-3\">\r\n      <div class=\"mini-square\" style=\"background-color: #FF9797; margin-top:2px;\"></div>\r\n      <div class=\"ps-3\">\r\n        <div class=\"b-14-gray text-start\">\r\n          {{ t('activity.palabras') }}\r\n        </div>\r\n        <div class=\"r-12-gray text-start\" v-tooltip=\"t('activity.audio')\"\r\n          style=\"padding-right: 10px; width: fit-content; cursor: help;\">\r\n          {{ t('activity.audioMin') }}: {{ resumenMomentos[4] || 0 }}\r\n        </div>\r\n        <div class=\"r-12-gray text-start\" v-tooltip=\"t('activity.horas')\"\r\n          style=\"padding-right: 10px; width: fit-content; cursor: help;\">\r\n          {{ t('activity.horasMin') }}: {{ formatTiempo(resumenTiempo?.[4] || 0) }}\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"d-flex justify-content-start pt-3 pb-4\">\r\n      <div class=\"mini-square\" style=\"background-color: #fb5353; margin-top:2px;\"></div>\r\n      <div class=\"ps-3\">\r\n        <div class=\"b-14-gray text-start\">\r\n          {{ t('activity.hablar') }}\r\n        </div>\r\n        <div class=\"r-12-gray text-start\" v-tooltip=\"t('activity.audio')\"\r\n          style=\"padding-right: 10px; width: fit-content; cursor: help;\">\r\n          {{ t('activity.audioMin') }}: {{ resumenMomentos[5] || 0 }}\r\n        </div>\r\n        <div class=\"r-12-gray text-start\" v-tooltip=\"t('activity.horas')\"\r\n          style=\"padding-right: 10px; width: fit-content; cursor: help;\">\r\n          {{ t('activity.horasMin') }}: {{ formatTiempo(resumenTiempo?.[5] || 0) }}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\n/*Imports*/\r\nimport { ref, computed, onMounted, onUnmounted } from 'vue';\r\nimport { API_BASE_URL } from '@/config/api'\r\nimport { useI18n } from 'vue-i18n'\r\nimport { Tooltip } from 'bootstrap';\r\nimport { Bar } from 'vue-chartjs';\r\nimport { Chart as ChartJS, Title, Tooltip as ChartTooltip, Legend, BarElement, CategoryScale, LinearScale } from 'chart.js';\r\nimport ChartDataLabels from 'chartjs-plugin-datalabels';\r\n\r\n// Registramos el plugin en ChartJS\r\nChartJS.register(Title, ChartTooltip, Legend, BarElement, CategoryScale, LinearScale, ChartDataLabels);\r\n\r\n/*Declaraciones*/\r\nconst { t, locale } = useI18n();\r\nconst temporalidad = ref(1);\r\nconst selectedOption = ref(1)\r\nconst mesSeleccionado = ref(0);\r\nconst semanaSeleccionada = ref(0);\r\nconst diaSeleccionado = ref(0)\r\n//Map de calor\r\nconst apiData = ref([]);\r\nconst selectedBlock = ref(null); // Estado para controlar qué tooltip está abierto\r\n// const dataColorEs = ref({});\r\nconst coloresMomentos = [\r\n  \"#efefef\", // Momento 0\r\n  \"#E3FCFF\", // Momento 1\r\n  \"#FFE4B3\", // Momento 2\r\n  \"#FFC4B3\", // Momento 3\r\n  \"#FF9797\", // Momento 4\r\n  \"#fb5353\"  // Momento 5\r\n];\r\n\r\nonMounted(() => {\r\n  GetMomentsAudios();\r\n  window.addEventListener('click', handleGlobalClick);\r\n});\r\n\r\nonUnmounted(() => {\r\n  window.removeEventListener('click', handleGlobalClick); //Removemos la escucha del click global\r\n});\r\n\r\nfunction GetDatos(x) {\r\n  temporalidad.value = x;\r\n  selectedOption.value = x;\r\n  GetMomentsAudios();\r\n}\r\n\r\n/* Apis */\r\n//Momentos\r\nasync function GetMomentsAudios() {\r\n  try {\r\n    const sesion = localStorage.getItem(\"token\");\r\n    if (!sesion) return;\r\n\r\n    const response = await fetch(`${API_BASE_URL}/api/config/GetUserMoments`, {\r\n      method: \"POST\",\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n      body: JSON.stringify({\r\n        user: sesion, temporalidad: temporalidad.value, mes: mesSeleccionado.value,\r\n        semana: semanaSeleccionada.value, dia: diaSeleccionado.value\r\n      })\r\n    })\r\n\r\n    const data = await response.json()\r\n    const parsedData = typeof data.data === 'string' ? JSON.parse(data.data) : data.data;\r\n\r\n    apiData.value = Array.isArray(parsedData) ? parsedData : [];\r\n  }\r\n  catch (e) { console.error(\"Error momentos\", e) }\r\n}\r\n\r\n/* Funciones generales */\r\n// Función para manejar el clic global y cerrar tooltips\r\nconst handleGlobalClick = (event) => {\r\n  if (!event.target.closest('.bloque-celda')) {\r\n    selectedBlock.value = null;\r\n  }\r\n};\r\nconst formatTiempo = (segundos) => {\r\n  if (segundos === 0 || !segundos) return \"0s\";\r\n\r\n  if (segundos < 60) {\r\n    // Menos de un minuto\r\n    return `${segundos}s`;\r\n  } else if (segundos < 3600) {\r\n    // Menos de una hora -> Convertir a minutos\r\n    const minutos = Math.floor(segundos / 60);\r\n    const segundosRestantes = segundos % 60;\r\n\r\n    // Si los segundos restantes son 0, solo mostramos minutos\r\n    return segundosRestantes === 0\r\n      ? `${minutos}m`\r\n      : `${minutos}m ${segundosRestantes}s`;\r\n  } else {\r\n    // Una hora o más\r\n    const horas = Math.floor(segundos / 3600);\r\n    const minutosRestantes = Math.floor((segundos % 3600) / 60);\r\n\r\n    return minutosRestantes === 0\r\n      ? `${horas}h`\r\n      : `${horas}h ${minutosRestantes}m`;\r\n  }\r\n};\r\n\r\n/* Contador de audios */\r\n//Cuenta los audios\r\nconst countAudios = computed(() => {\r\n  if (!apiData.value || apiData.value.length === 0) return 0;\r\n\r\n  // Usamos reduce para sumar la propiedad Cantidad de cada registro\r\n  return apiData.value.reduce((total, item) => {\r\n    return total + (item.Cantidad || 0);\r\n  }, 0);\r\n});\r\n\r\n/* Tiempo de reproducción */\r\n//Suma de tiempo\r\nconst tiempoResumen = computed(() => {\r\n  const totalSegundos = apiData.value.reduce((total, item) => {\r\n    return total + (item.Tiempo || 0);\r\n  }, 0);\r\n\r\n  return {\r\n    h: Math.floor(totalSegundos / 3600),\r\n    m: Math.floor((totalSegundos % 3600) / 60),\r\n    s: totalSegundos % 60\r\n  };\r\n});\r\n\r\n/* Funciones de gráfica de barras */\r\n// Datos de gráfica\r\nconst chartData = computed(() => {\r\n  // 1. Agrupamos por 'Numero' para sumar cantidades y obtener la etiqueta por idioma\r\n  const grupos = apiData.value.reduce((acc, item) => {\r\n    const n = item.Numero;\r\n    if (!acc[n]) {\r\n      acc[n] = {\r\n        label: locale.value.startsWith('es') ? item.Etiqueta : item.Label,\r\n        cantidad: 0,\r\n        numero: n // Guardamos el Numero original para el clic\r\n      };\r\n    }\r\n    acc[n].cantidad += item.Cantidad || 0;\r\n    return acc;\r\n  }, {});\r\n\r\n  // 2. Ordenar por la propiedad Numero\r\n  const ordenados = Object.values(grupos).sort((a, b) => a.numero - b.numero);\r\n\r\n  // RETORNO MODIFICADO:\r\n  return {\r\n    labels: ordenados.map(d => d.label),\r\n    rawItems: ordenados,\r\n    datasets: [\r\n      {\r\n        label: t('activity.cantidadAudios'),\r\n        data: ordenados.map(d => d.cantidad),\r\n        backgroundColor: '#177e99',\r\n        borderRadius: 4,\r\n        barThickness: 25\r\n      }\r\n    ]\r\n  };\r\n});\r\n//Configuración de gráfica\r\nconst chartOptions = {\r\n  responsive: true,\r\n  maintainAspectRatio: false,\r\n  plugins: {\r\n    legend: { display: false },\r\n    tooltip: {\r\n      enabled: false \r\n    },\r\n    datalabels: {\r\n      anchor: 'end',\r\n      align: 'top',\r\n      formatter: Math.round,\r\n      font: {\r\n        weight: 'bold',\r\n        size: 12\r\n      },\r\n      color: '#333'\r\n    }\r\n  },\r\n  layout: {\r\n    padding: {\r\n      top: 20\r\n    }\r\n  },\r\n  scales: {\r\n    y: {\r\n      beginAtZero: true,\r\n      grid: { display: false },\r\n      ticks: { display: false }\r\n    },\r\n    x: {\r\n      grid: { display: false }\r\n    }\r\n  },\r\n  onClick: (event, elements) => {\r\n    if (elements.length > 0) {\r\n      const index = elements[0].index;\r\n      const selectedItem = chartData.value.rawItems[index];\r\n\r\n      handleDrillDown(selectedItem.numero);\r\n    }\r\n  },\r\n  // Importante para que el cursor cambie al pasar sobre las barras\r\n  onHover: (event, chartElement) => {\r\n    event.native.target.style.cursor = chartElement[0] ? 'pointer' : 'default';\r\n  }\r\n};\r\n//Bajar de nivel\r\nconst handleDrillDown = (numero) => {\r\n  if (temporalidad.value == 3) {\r\n    mesSeleccionado.value = numero;\r\n    temporalidad.value = 2; \r\n  }\r\n  else if (temporalidad.value == 2) {\r\n    semanaSeleccionada.value = numero;\r\n    temporalidad.value = 1; \r\n  }\r\n  else if (temporalidad.value == 1) {\r\n    diaSeleccionado.value = numero;\r\n    temporalidad.value = 1; \r\n  }\r\n  // Refrescamos los datos con los nuevos filtros\r\n  selectedOption.value = temporalidad.value;\r\n  GetMomentsAudios();\r\n};\r\n//Regresar\r\nconst goBack = () => {\r\n  if (temporalidad.value == 1 && diaSeleccionado.value == 0) {\r\n    temporalidad.value = 2;\r\n    semanaSeleccionada.value = 0;\r\n    diaSeleccionado.value = 0;\r\n  } else if (temporalidad.value == 1 && diaSeleccionado.value > 0) {\r\n    temporalidad.value = 1;\r\n    diaSeleccionado.value = 0;\r\n  } else if (temporalidad.value == 2) {\r\n    temporalidad.value = 3;\r\n    mesSeleccionado.value = 0;\r\n  }\r\n  selectedOption.value = temporalidad.value;\r\n  GetMomentsAudios();\r\n};\r\n\r\n/* Funciones de Mapa de calor */\r\n//Nombre de columnas\r\nconst tableHeaders = computed(() => {\r\n  if (!apiData.value.length) return [];\r\n\r\n  const allLabels = apiData.value.map(item => ({\r\n    name: locale.value.startsWith('es') ? item.Etiqueta : item.Label,\r\n    numero: item.Numero\r\n  }));\r\n\r\n  const uniqueHeaders = allLabels.filter((value, index, self) =>\r\n    index === self.findIndex((t) => t.name === value.name)\r\n  );\r\n\r\n  return uniqueHeaders.sort((a, b) => a.numero - b.numero);\r\n});\r\n//Obtener color del momento\r\nconst getMomentoColor = (momento) => {\r\n  return coloresMomentos[momento] || \"#FFFFFF\";\r\n};\r\n//Datos de Mapa\r\nconst tableColumns = computed(() => {\r\n  if (!apiData.value.length || !tableHeaders.value.length) return {};\r\n\r\n  const columns = {};\r\n\r\n  tableHeaders.value.forEach(header => {\r\n    const registrosDia = apiData.value.filter(item => {\r\n      const itemName = locale.value.startsWith('es') ? item.Etiqueta : item.Label;\r\n      return itemName === header.name && item.Bloque;\r\n    });\r\n\r\n    columns[header.name] = registrosDia.sort((a, b) => a.Bloque.localeCompare(b.Bloque));\r\n  });\r\n\r\n  return columns;\r\n});\r\n// Calculamos el número máximo de filas para que la tabla sea uniforme\r\nconst maxRows = computed(() => {\r\n  const counts = Object.values(tableColumns.value).map(col => col.length);\r\n  return counts.length ? Math.max(...counts) : 0;\r\n});\r\n// Función para alternar el tooltip (abrir/cerrar al hacer click)\r\nconst toggleTooltip = (block) => {\r\n  if (selectedBlock.value === block)\r\n    selectedBlock.value = null;\r\n  else\r\n    selectedBlock.value = block;\r\n};\r\n// Resumen de Cantidad de Audios\r\nconst resumenMomentos = computed(() => {\r\n  const resumen = {};\r\n\r\n  apiData.value.forEach(item => {\r\n    const m = item.Momento;\r\n    if (m !== undefined && m !== null) {\r\n      if (!resumen[m]) resumen[m] = 0;\r\n\r\n      resumen[m] += item.Cantidad || 0;\r\n    }\r\n  });\r\n\r\n  return resumen;\r\n});\r\n// Resumen de Tiempo Total\r\nconst resumenTiempo = computed(() => {\r\n  const resumen = {};\r\n\r\n  apiData.value.forEach(item => {\r\n    const m = item.Momento;\r\n    if (m !== undefined && m !== null) {\r\n      if (!resumen[m]) resumen[m] = 0;\r\n\r\n      resumen[m] += item.Tiempo || 0;\r\n    }\r\n  });\r\n\r\n  return resumen;\r\n});\r\n//Tooltips de momentos\r\nconst vTooltip = {\r\n  mounted(el, binding) {\r\n    el._tooltip = new Tooltip(el, {\r\n      title: binding.value,\r\n      placement: 'top',\r\n      trigger: 'hover'\r\n    });\r\n  },\r\n  updated(el, binding) {\r\n    if (el._tooltip && binding.value !== binding.oldValue) {\r\n      el._tooltip.setContent({ '.tooltip-inner': binding.value });\r\n    }\r\n  },\r\n  unmounted(el) {\r\n    if (el._tooltip) {\r\n      el._tooltip.dispose();\r\n      delete el._tooltip;\r\n    }\r\n  }\r\n};\r\n</script>\r\n<style scoped>\r\n.pila-table {\r\n  width: 100%;\r\n  border-collapse: collapse;\r\n}\r\n\r\n.pila-table td {\r\n  vertical-align: bottom;\r\n  height: 50px;\r\n  border: 1px solid #eee;\r\n  padding: 0px;\r\n}\r\n\r\n.bloque-celda {\r\n  background-color: #f0f4f8;\r\n  border-radius: 4px;\r\n  padding: 8px;\r\n  margin: 2px 0;\r\n  text-align: center;\r\n  font-weight: bold;\r\n}\r\n\r\n.pila-table th {\r\n  padding: 12px;\r\n  background-color: #2c3e50;\r\n  color: white;\r\n}\r\n\r\n.bloque-celda {\r\n  border-radius: 4px;\r\n  padding: 8px;\r\n  margin: 2px 0;\r\n  text-align: center;\r\n  font-weight: bold;\r\n  font-size: 0.9em;\r\n  transition: background-color 0.3s ease;\r\n  border: 1px solid rgba(0, 0, 0, 0.05);\r\n  color: #333;\r\n}\r\n\r\n.bloque-celda-wrapper {\r\n  position: relative;\r\n  display: flex;\r\n  justify-content: center;\r\n}\r\n\r\n.bloque-celda {\r\n  cursor: pointer;\r\n  position: relative;\r\n  width: 90%;\r\n}\r\n\r\n.bloque-celda:hover {\r\n  filter: brightness(0.95);\r\n}\r\n\r\n.custom-tooltip {\r\n  position: absolute;\r\n  bottom: 125%;\r\n  left: 50%;\r\n  transform: translateX(-50%);\r\n  background-color: #333;\r\n  color: #fff;\r\n  padding: 8px 12px;\r\n  border-radius: 6px;\r\n  font-size: 0.8rem;\r\n  white-space: nowrap;\r\n  z-index: 100;\r\n  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);\r\n  pointer-events: none;\r\n}\r\n\r\n.tooltip-arrow {\r\n  position: absolute;\r\n  top: 100%;\r\n  left: 50%;\r\n  margin-left: -5px;\r\n  border-width: 5px;\r\n  border-style: solid;\r\n  border-color: #333 transparent transparent transparent;\r\n}\r\n</style>","import script from \"./AngerDashboard.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./AngerDashboard.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./AngerDashboard.vue?vue&type=style&index=0&id=eec29328&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-eec29328\"]])\n\nexport default __exports__"],"names":["ChartJS","register","Title","ChartTooltip","Legend","BarElement","CategoryScale","LinearScale","ChartDataLabels","t","locale","useI18n","temporalidad","ref","selectedOption","mesSeleccionado","semanaSeleccionada","diaSeleccionado","apiData","selectedBlock","coloresMomentos","GetDatos","x","value","GetMomentsAudios","async","sesion","localStorage","getItem","response","fetch","API_BASE_URL","method","headers","body","JSON","stringify","user","mes","semana","dia","data","json","parsedData","parse","Array","isArray","e","console","error","onMounted","window","addEventListener","handleGlobalClick","onUnmounted","removeEventListener","event","target","closest","formatTiempo","segundos","minutos","Math","floor","segundosRestantes","horas","minutosRestantes","countAudios","computed","length","reduce","total","item","Cantidad","tiempoResumen","totalSegundos","Tiempo","h","m","s","chartData","grupos","acc","n","Numero","label","startsWith","Etiqueta","Label","cantidad","numero","ordenados","Object","values","sort","a","b","labels","map","d","rawItems","datasets","backgroundColor","borderRadius","barThickness","chartOptions","responsive","maintainAspectRatio","plugins","legend","display","tooltip","enabled","datalabels","anchor","align","formatter","round","font","weight","size","color","layout","padding","top","scales","y","beginAtZero","grid","ticks","onClick","elements","index","selectedItem","handleDrillDown","onHover","chartElement","native","style","cursor","goBack","tableHeaders","allLabels","name","uniqueHeaders","filter","self","findIndex","getMomentoColor","momento","tableColumns","columns","forEach","header","registrosDia","itemName","Bloque","localeCompare","maxRows","counts","col","max","toggleTooltip","block","resumenMomentos","resumen","Momento","undefined","resumenTiempo","vTooltip","mounted","el","binding","_tooltip","Tooltip","title","placement","trigger","updated","oldValue","setContent","unmounted","dispose","__exports__"],"sourceRoot":""}